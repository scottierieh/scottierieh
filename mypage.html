<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ğŸ“Š Statistical Analysis Platform</title>

<style>
  :root{
    --bg:#f8fafc; --card:#ffffff; --muted:#64748b; --accent:#3b82f6; --success:#10b981;
    --warning:#f59e0b; --danger:#ef4444; --purple:#8b5cf6; --info:#06b6d4;
    --shadow:0 4px 6px -1px rgba(0,0,0,0.1); --shadow-lg:0 10px 15px -3px rgba(0,0,0,0.1);
    --gradient:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
  }
  
  * {box-sizing:border-box;margin:0;padding:0;}
  
  body{font-family:'Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:var(--bg);color:#1e293b;line-height:1.6;margin:0;padding:0}
  
  /* Header Navigation */
  .header{background:white;border-bottom:1px solid #e2e8f0;position:sticky;top:0;z-index:100;box-shadow:var(--shadow)}
  .header-content{max-width:1400px;margin:0 auto;padding:0 24px;display:flex;align-items:center;justify-content:space-between;height:64px}
  
  .logo{display:flex;align-items:center;gap:12px;font-weight:700;font-size:20px;cursor:pointer}
  .logo-icon{width:40px;height:40px;background:var(--gradient);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:24px}
  
  /* Main Tabs */
  .main-tabs{
    display:flex;
    gap:4px;
    background:#f1f5f9;
    padding:4px;
    border-radius:12px;
  }
  
  .main-tab{
    padding:8px 16px;
    border-radius:8px;
    border:none;
    background:transparent;
    cursor:pointer;
    font-weight:500;
    color:#64748b;
    transition:all 0.2s;
    white-space:nowrap;
    font-size:14px;
  }
  
  .main-tab.active{
    background:white;
    color:#1e293b;
    box-shadow:0 1px 3px rgba(0,0,0,0.1);
  }
  
  .main-tab:hover:not(.active){
    color:#1e293b;
  }
  
  .header-actions{display:flex;gap:12px;align-items:center}
  .user-avatar{width:36px;height:36px;border-radius:50%;background:linear-gradient(135deg,#667eea,#764ba2);display:flex;align-items:center;justify-content:center;color:white;font-weight:600}
  
  .btn{border:0;padding:10px 20px;border-radius:10px;cursor:pointer;font-weight:500;transition:all 0.2s;display:inline-flex;align-items:center;gap:8px}
  .btn:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,0,0,0.15)}
  .btn.primary{background:var(--accent);color:#fff}
  .btn.success{background:var(--success);color:#fff}
  .btn.ghost{background:#f1f5f9;color:#475569}
  .btn.small{padding:6px 12px;font-size:13px}
  .btn.icon{padding:8px;width:36px;height:36px;justify-content:center}
  
  /* Main container */
  .main-container{
    max-width:1400px;
    margin:40px auto;
    padding:0 24px;
  }
  
  /* Tab Content */
  .tab-content{
    display:none;
  }
  
  .tab-content.active{
    display:block;
  }
  
  /* Hero Section */
  .hero-section{
    text-align:center;
    margin-bottom:48px;
  }
  
  .hero-title{
    font-size:48px;
    font-weight:800;
    background:var(--gradient);
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    background-clip:text;
    margin-bottom:16px;
  }
  
  .hero-subtitle{
    font-size:20px;
    color:var(--muted);
  }
  
  /* Tools Grid */
  .category-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(300px,1fr));
    gap:24px;
    margin-bottom:32px;
  }
  
  .category-card{
    background:white;
    border-radius:16px;
    padding:32px;
    box-shadow:var(--shadow);
    cursor:pointer;
    transition:all 0.3s;
    border:2px solid transparent;
    position:relative;
    overflow:hidden;
  }
  
  .category-card::before{
    content:'';
    position:absolute;
    top:0;
    left:0;
    right:0;
    height:4px;
    background:var(--gradient);
    transform:scaleX(0);
    transition:transform 0.3s;
  }
  
  .category-card:hover::before{
    transform:scaleX(1);
  }
  
  .category-card:hover{
    transform:translateY(-4px);
    box-shadow:var(--shadow-lg);
    border-color:#e2e8f0;
  }
  
  .category-icon{
    width:60px;
    height:60px;
    background:#f1f5f9;
    border-radius:12px;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:28px;
    margin-bottom:20px;
  }
  
  .category-card:nth-child(1) .category-icon{background:linear-gradient(135deg,#667eea,#764ba2);color:white}
  .category-card:nth-child(2) .category-icon{background:linear-gradient(135deg,#3b82f6,#06b6d4);color:white}
  .category-card:nth-child(3) .category-icon{background:linear-gradient(135deg,#8b5cf6,#a855f7);color:white}
  .category-card:nth-child(4) .category-icon{background:linear-gradient(135deg,#10b981,#059669);color:white}
  .category-card:nth-child(5) .category-icon{background:linear-gradient(135deg,#f59e0b,#f97316);color:white}
  .category-card:nth-child(6) .category-icon{background:linear-gradient(135deg,#ef4444,#f87171);color:white}
  .category-card:nth-child(7) .category-icon{background:linear-gradient(135deg,#06b6d4,#0891b2);color:white}
  
  .category-title{
    font-size:20px;
    font-weight:700;
    color:#1e293b;
    margin-bottom:8px;
  }
  
  .category-desc{
    font-size:14px;
    color:var(--muted);
    line-height:1.5;
    margin-bottom:16px;
  }
  
  .category-items{
    display:flex;
    flex-wrap:wrap;
    gap:6px;
  }
  
  .category-tag{
    padding:4px 8px;
    background:#f8fafc;
    border-radius:6px;
    font-size:12px;
    color:#64748b;
  }
  
  /* Projects Board Styles */
  .projects-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:32px;
  }
  
  .projects-stats{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
    gap:16px;
    margin-bottom:32px;
  }
  
  .stat-card{
    background:white;
    border-radius:12px;
    padding:20px;
    box-shadow:var(--shadow);
    position:relative;
    overflow:hidden;
  }
  
  .stat-card::before{
    content:'';
    position:absolute;
    top:0;
    left:0;
    right:0;
    height:4px;
    background:var(--gradient);
  }
  
  .stat-icon{
    width:40px;
    height:40px;
    background:#f1f5f9;
    border-radius:10px;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:20px;
    margin-bottom:12px;
    color:var(--accent);
  }
  
  .stat-value{
    font-size:24px;
    font-weight:700;
    color:#1e293b;
    margin-bottom:4px;
  }
  
  .stat-label{
    font-size:14px;
    color:var(--muted);
  }
  
  /* Projects Grid */
  .projects-grid{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(320px,1fr));
    gap:20px;
  }
  
  .project-card{
    background:white;
    border-radius:12px;
    padding:20px;
    box-shadow:var(--shadow);
    transition:all 0.3s;
    border-left:4px solid #e2e8f0;
    cursor:pointer;
  }
  
  .project-card:hover{
    transform:translateY(-2px);
    box-shadow:var(--shadow-lg);
  }
  
  .project-card.ipa{border-left-color:var(--accent)}
  .project-card.statistics{border-left-color:var(--success)}
  .project-card.survey{border-left-color:var(--purple)}
  
  .project-header{
    display:flex;
    justify-content:space-between;
    align-items:flex-start;
    margin-bottom:12px;
  }
  
  .project-title{
    font-weight:600;
    color:#1e293b;
    margin-bottom:4px;
  }
  
  .project-type{
    padding:2px 8px;
    border-radius:4px;
    font-size:12px;
    font-weight:500;
  }
  
  .project-type.ipa{background:#dbeafe;color:#1e40af}
  .project-type.statistics{background:#d1fae5;color:#065f46}
  .project-type.survey{background:#e9d5ff;color:#6b21a8}
  
  .project-desc{
    font-size:14px;
    color:var(--muted);
    margin-bottom:12px;
    line-height:1.4;
  }
  
  .project-meta{
    display:flex;
    justify-content:space-between;
    align-items:center;
    font-size:12px;
    color:var(--muted);
  }
  
  .project-date{
    display:flex;
    align-items:center;
    gap:4px;
  }
  
  .project-responses{
    display:flex;
    align-items:center;
    gap:4px;
    font-weight:500;
  }
  
  /* Empty State */
  .empty-state{
    text-align:center;
    padding:60px 20px;
    background:white;
    border-radius:12px;
    box-shadow:var(--shadow);
  }
  
  .empty-icon{
    font-size:48px;
    margin-bottom:16px;
    opacity:0.5;
  }
  
  .empty-title{
    font-size:18px;
    font-weight:600;
    color:#1e293b;
    margin-bottom:8px;
  }
  
  .empty-desc{
    color:var(--muted);
    margin-bottom:24px;
  }
  
  /* Responsive */
  @media (max-width: 768px) {
    .header-content{padding:0 16px}
    .category-grid{grid-template-columns:1fr}
    .projects-grid{grid-template-columns:1fr}
    .hero-title{font-size:32px}
    .projects-header{flex-direction:column;gap:16px;align-items:flex-start}
  }
</style>
</head>
<body>

<!-- Header Navigation -->
<div class="header">
  <div class="header-content">
    <div class="logo" onclick="switchMainTab('tools')">
      <div class="logo-icon">ğŸ“Š</div>
      <span>Statistical Analysis Platform</span>
    </div>
    
    <!-- Main Tabs -->
    <div class="main-tabs">
      <button class="main-tab active" onclick="switchMainTab('projects')">ğŸ“ My Projects</button>
      <button class="main-tab" onclick="switchMainTab('survey')">ğŸ“‹ Survey Tools</button>
      <button class="main-tab" onclick="switchMainTab('analysis')">ğŸ“Š Analysis Tools</button>
    </div>
    
    <div class="header-actions">
      <button class="btn ghost icon">ğŸ””</button>
      <button class="btn ghost icon">âš™ï¸</button>
      <button class="btn primary small">ğŸ“¥ Export</button>
      <div class="user-avatar">AD</div>
    </div>
  </div>
</div>

<!-- Main Content -->
<div class="main-container">
  
  <!-- My Projects Tab -->
  <div class="tab-content active" id="projects-tab">
    <div class="projects-header">
      <div>
        <h1 style="font-size:32px;font-weight:700;color:#1e293b;margin-bottom:8px">My Projects</h1>
        <p style="color:var(--muted)">Manage and track your analysis projects</p>
      </div>
      <div style="display:flex;gap:12px">
        <button class="btn ghost small" onclick="refreshProjects()">ğŸ”„ Refresh</button>
        <button class="btn primary small" onclick="createNewProject()">+ New Project</button>
      </div>
    </div>
    
    <!-- Project Statistics -->
    <div class="projects-stats">
      <div class="stat-card">
        <div class="stat-icon">ğŸ“Š</div>
        <div class="stat-value" id="total-projects">0</div>
        <div class="stat-label">Total Projects</div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">ğŸ“‹</div>
        <div class="stat-value" id="active-surveys">0</div>
        <div class="stat-label">Active Surveys</div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">ğŸ“ˆ</div>
        <div class="stat-value" id="total-responses">0</div>
        <div class="stat-label">Total Responses</div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">â±ï¸</div>
        <div class="stat-value" id="recent-activity">0</div>
        <div class="stat-label">This Week</div>
      </div>
    </div>
    
    <!-- Projects Grid -->
    <div id="projects-container">
      <!-- Projects will be loaded here -->
    </div>
  </div>
  
  <!-- Survey Tools Tab -->
  <div class="tab-content" id="survey-tab">
    <div class="hero-section">
      <h1 class="hero-title">Survey Research Tools</h1>
      <p class="hero-subtitle">Design, collect, and analyze survey data</p>
    </div>
    
    <div class="category-grid">
      <!-- IPA Survey -->
      <div class="category-card" onclick="openTool('ipa')">
        <div class="category-icon">ğŸ“‹</div>
        <h3 class="category-title">IPA Survey</h3>
        <p class="category-desc">Importance-Performance Analysis for customer satisfaction and service quality measurement</p>
        <div class="category-items">
          <span class="category-tag">Survey Design</span>
          <span class="category-tag">Data Collection</span>
          <span class="category-tag">IPA Matrix</span>
          <span class="category-tag">Analysis</span>
        </div>
      </div>
      
      <!-- Survey Builder -->
      <div class="category-card" onclick="openTool('survey-builder')">
        <div class="category-icon">ğŸ—ï¸</div>
        <h3 class="category-title">Survey Builder</h3>
        <p class="category-desc">General purpose survey creation tool with multiple question types and logic</p>
        <div class="category-items">
          <span class="category-tag">Question Types</span>
          <span class="category-tag">Logic Rules</span>
          <span class="category-tag">Templates</span>
        </div>
      </div>
      
      <!-- Form Creator -->
      <div class="category-card" onclick="openTool('form-creator')">
        <div class="category-icon">ğŸ“</div>
        <h3 class="category-title">Form Creator</h3>
        <p class="category-desc">Create custom forms for data collection, registration, and feedback</p>
        <div class="category-items">
          <span class="category-tag">Custom Fields</span>
          <span class="category-tag">Validation</span>
          <span class="category-tag">Export</span>
        </div>
      </div>
      
      <!-- Poll Maker -->
      <div class="category-card" onclick="openTool('poll-maker')">
        <div class="category-icon">ğŸ—³ï¸</div>
        <h3 class="category-title">Poll Maker</h3>
        <p class="category-desc">Quick polling tool for real-time voting and opinion collection</p>
        <div class="category-items">
          <span class="category-tag">Real-time</span>
          <span class="category-tag">Multiple Choice</span>
          <span class="category-tag">Live Results</span>
        </div>
      </div>
      
      <!-- Quiz Builder -->
      <div class="category-card" onclick="openTool('quiz-builder')">
        <div class="category-icon">ğŸ§ </div>
        <h3 class="category-title">Quiz Builder</h3>
        <p class="category-desc">Create educational quizzes and assessments with scoring and feedback</p>
        <div class="category-items">
          <span class="category-tag">Scoring</span>
          <span class="category-tag">Feedback</span>
          <span class="category-tag">Timer</span>
        </div>
      </div>
      
      <!-- 360 Feedback -->
      <div class="category-card" onclick="openTool('360-feedback')">
        <div class="category-icon">ğŸ”„</div>
        <h3 class="category-title">360Â° Feedback</h3>
        <p class="category-desc">Multi-source feedback collection for performance evaluation and development</p>
        <div class="category-items">
          <span class="category-tag">Multi-rater</span>
          <span class="category-tag">Anonymous</span>
          <span class="category-tag">Reports</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Analysis Tools Tab -->
  <div class="tab-content" id="analysis-tab">
    <div class="hero-section">
      <h1 class="hero-title">Statistical Analysis Tools</h1>
      <p class="hero-subtitle">Advanced statistical analysis and data processing</p>
    </div>
    
    <div class="category-grid">
      <!-- Data Editor -->
      <div class="category-card" onclick="openTool('dataeditor')">
        <div class="category-icon">ğŸ“</div>
        <h3 class="category-title">Data Editor</h3>
        <p class="category-desc">Data entry, editing, transformation, and management tools for statistical analysis</p>
        <div class="category-items">
          <span class="category-tag">Import/Export</span>
          <span class="category-tag">Transform</span>
          <span class="category-tag">Clean</span>
          <span class="category-tag">Merge</span>
        </div>
      </div>
      
      <!-- Basic Statistics -->
      <div class="category-card" onclick="openTool('basic')">
        <div class="category-icon">ğŸ“Š</div>
        <h3 class="category-title">Statistics</h3>
        <p class="category-desc">Basic statistical analysis including descriptive statistics, hypothesis testing, and correlation analysis</p>
        <div class="category-items">
          <span class="category-tag">Descriptive</span>
          <span class="category-tag">t-test</span>
          <span class="category-tag">ANOVA</span>
          <span class="category-tag">Regression</span>
        </div>
      </div>
      
      <!-- Advanced Analysis -->
      <div class="category-card" onclick="openTool('advanced')">
        <div class="category-icon">ğŸ”¬</div>
        <h3 class="category-title">Advanced Analysis</h3>
        <p class="category-desc">Advanced statistical methods including multivariate analysis and machine learning</p>
        <div class="category-items">
          <span class="category-tag">Multivariate</span>
          <span class="category-tag">ML</span>
          <span class="category-tag">Factor Analysis</span>
          <span class="category-tag">SEM</span>
        </div>
      </div>
      
      <!-- Econometrics -->
      <div class="category-card" onclick="openTool('econometrics')">
        <div class="category-icon">ğŸ’¹</div>
        <h3 class="category-title">Econometrics</h3>
        <p class="category-desc">Economic data analysis, time series, panel data, and causal inference methods</p>
        <div class="category-items">
          <span class="category-tag">Time Series</span>
          <span class="category-tag">Panel Data</span>
          <span class="category-tag">IV</span>
        </div>
      </div>
      
      <!-- Reliability Testing -->
      <div class="category-card" onclick="openTool('reliability')">
        <div class="category-icon">âœ…</div>
        <h3 class="category-title">Reliability Testing</h3>
        <p class="category-desc">Test reliability and validity of scales, questionnaires, and measurement instruments</p>
        <div class="category-items">
          <span class="category-tag">Cronbach's Alpha</span>
          <span class="category-tag">Factor Analysis</span>
          <span class="category-tag">Validity</span>
        </div>
      </div>
      
      <!-- Optimization -->
      <div class="category-card" onclick="openTool('optimization')">
        <div class="category-icon">ğŸ¯</div>
        <h3 class="category-title">Optimization</h3>
        <p class="category-desc">Optimization techniques, linear programming, and operations research methods</p>
        <div class="category-items">
          <span class="category-tag">Linear Programming</span>
          <span class="category-tag">Simplex</span>
          <span class="category-tag">Integer</span>
        </div>
      </div>
      
      <!-- Simulation -->
      <div class="category-card" onclick="openTool('simulation')">
        <div class="category-icon">ğŸ²</div>
        <h3 class="category-title">Simulation</h3>
        <p class="category-desc">Monte Carlo simulation, bootstrap methods, and stochastic modeling</p>
        <div class="category-items">
          <span class="category-tag">Monte Carlo</span>
          <span class="category-tag">Bootstrap</span>
          <span class="category-tag">Markov</span>
        </div>
      </div>
    </div>
  </div>

<script>
// ìƒ˜í”Œ ë°ì´í„° ì œê±° - ë¹ˆ ë°°ì—´ë¡œ ì‹œì‘
let projects = [];

// IPA í”„ë¡œì íŠ¸ ë¡œë“œ í•¨ìˆ˜
function loadIPAProjects() {
  const ipaSurveyData = localStorage.getItem('ipaSurveyData');
  let allProjects = JSON.parse(localStorage.getItem('allProjects') || '[]');
  
  console.log('IPA Survey Data:', ipaSurveyData); // ë””ë²„ê¹…ìš©
  
  // IPA ì„¤ë¬¸ì´ ì €ì¥ë˜ì–´ ìˆìœ¼ë©´ í”„ë¡œì íŠ¸ ëª©ë¡ì— ì¶”ê°€
  if (ipaSurveyData) {
    try {
      const surveyData = JSON.parse(ipaSurveyData);
      console.log('Parsed Survey Data:', surveyData); // ë””ë²„ê¹…ìš©
      
      if (surveyData.title || surveyData.attributes?.length > 0) {
        // ì´ë¯¸ ì¶”ê°€ëœ í”„ë¡œì íŠ¸ì¸ì§€ í™•ì¸
        const existingProjectIndex = allProjects.findIndex(p => p.id === 'ipa-main');
        
        const projectData = {
          id: 'ipa-main',
          title: surveyData.title || 'Untitled IPA Survey',
          type: 'ipa',
          description: surveyData.description || 'Importance-Performance Analysis Survey',
          createdAt: existingProjectIndex >= 0 ? allProjects[existingProjectIndex].createdAt : new Date().toISOString(),
          lastModified: new Date().toISOString(),
          responses: surveyData.responses ? surveyData.responses.length : 0,
          status: surveyData.responses && surveyData.responses.length > 0 ? 'active' : 'draft',
          attributes: surveyData.attributes?.length || 0
        };
        
        console.log('Project Data:', projectData); // ë””ë²„ê¹…ìš©
        
        if (existingProjectIndex >= 0) {
          // ê¸°ì¡´ í”„ë¡œì íŠ¸ ì—…ë°ì´íŠ¸
          allProjects[existingProjectIndex] = projectData;
        } else {
          // ìƒˆ í”„ë¡œì íŠ¸ ì¶”ê°€
          allProjects.push(projectData);
        }
        
        localStorage.setItem('allProjects', JSON.stringify(allProjects));
        console.log('Saved to allProjects:', allProjects); // ë””ë²„ê¹…ìš©
      }
    } catch (e) {
      console.error('Error parsing IPA survey data:', e);
    }
  }
  
  return allProjects;
}

function switchMainTab(tab) {
  // Update tab buttons
  document.querySelectorAll('.main-tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.main-tab').forEach((t, index) => {
    if ((tab === 'projects' && index === 0) || (tab === 'survey' && index === 1) || (tab === 'analysis' && index === 2)) {
      t.classList.add('active');
    }
  });
  
  // Show/hide tab content
  document.querySelectorAll('.tab-content').forEach(content => {
    content.classList.remove('active');
  });
  document.getElementById(tab + '-tab').classList.add('active');
  
  // Load projects if switching to projects tab
  if (tab === 'projects') {
    loadProjects();
  }
}

function openTool(tool) {
 if (tool === 'ipa') {
   window.location.href = './ipa.html';
   return;
 }
 
 if (tool === 'dataeditor') {
   window.location.href = './data_editor.html';
   return;
 }
 
 if (tool === 'survey-builder') {
   window.location.href = './survey_builder.html';
   return;
 }
 
 if (tool === 'survey') {
   const choice = confirm('Open IPA (Importance-Performance Analysis) tool?');
   if (choice) {
     window.location.href = './ipa.html';
     return;
   }
    if (tool === 'statistics') {
   window.location.href = './statistics_main.html';
   return;
 }
 }
 
 alert(`Opening ${tool} tool... (To be implemented)`);
}

function loadProjects() {
  const container = document.getElementById('projects-container');
  projects = loadIPAProjects(); // IPA ë°ì´í„°ë„ í•¨ê»˜ ë¡œë“œ
  
  if (projects.length === 0) {
    container.innerHTML = `
      <div class="empty-state">
        <div class="empty-icon">ğŸ“Š</div>
        <div class="empty-title">No Projects Yet</div>
        <div class="empty-desc">Create your first analysis project to get started</div>
        <button class="btn primary" onclick="createNewProject()">Create Project</button>
      </div>
    `;
  } else {
    container.innerHTML = `
      <div class="projects-grid">
        ${projects.map(project => `
          <div class="project-card ${project.type}" onclick="openProject('${project.id}')">
            <div class="project-header">
              <div>
                <div class="project-title">${project.title}</div>
                <span class="project-type ${project.type}">${project.type.toUpperCase()}</span>
              </div>
            </div>
            <div class="project-desc">${project.description}</div>
            <div class="project-meta">
              <div class="project-date">
                ğŸ“… ${new Date(project.lastModified).toLocaleDateString()}
              </div>
              <div class="project-responses">
                ğŸ“Š ${project.responses} responses
              </div>
            </div>
          </div>
        `).join('')}
      </div>
    `;
  }
  
  updateProjectStats();
}

function updateProjectStats() {
  document.getElementById('total-projects').textContent = projects.length;
  document.getElementById('active-surveys').textContent = projects.filter(p => p.status === 'active').length;
  document.getElementById('total-responses').textContent = projects.reduce((sum, p) => sum + p.responses, 0);
  document.getElementById('recent-activity').textContent = projects.filter(p => {
    const weekAgo = new Date();
    weekAgo.setDate(weekAgo.getDate() - 7);
    return new Date(p.lastModified) > weekAgo;
  }).length;
}

function openProject(id) {
  const project = projects.find(p => p.id === id);
  if (project) {
    if (project.type === 'ipa') {
      window.location.href = './ipa.html';
    } else {
      alert(`Opening ${project.title}... (To be implemented)`);
    }
  }
}

function createNewProject() {
  const projectType = prompt('Enter project type (ipa/survey/statistics):');
  if (projectType) {
    if (projectType.toLowerCase() === 'ipa') {
      window.location.href = './ipa.html';
    } else {
      alert(`Creating new ${projectType} project... (To be implemented)`);
    }
  }
}

function refreshProjects() {
  loadProjects();
}

// Initialize projects when page loads
document.addEventListener('DOMContentLoaded', function() {
  // í˜ì´ì§€ ë¡œë“œ ì‹œ í•­ìƒ í”„ë¡œì íŠ¸ í™•ì¸
  console.log('Page loaded, checking for projects...');
  loadProjects();
  
  // Projects íƒ­ì´ í™œì„±í™”ë˜ë©´ ë‹¤ì‹œ ë¡œë“œ
  if (document.getElementById('projects-tab').classList.contains('active')) {
    loadProjects();
  }
});

// í˜ì´ì§€ê°€ ë‹¤ì‹œ í¬ì»¤ìŠ¤ë¥¼ ë°›ì„ ë•Œë„ í”„ë¡œì íŠ¸ ìƒˆë¡œê³ ì¹¨ (IPAì—ì„œ ëŒì•„ì™”ì„ ë•Œ)
window.addEventListener('focus', function() {
  console.log('Window focused, refreshing projects...');
  if (document.getElementById('projects-tab').classList.contains('active')) {
    loadProjects();
  }
});

// localStorage ë³€ê²½ ê°ì§€ (ê°™ì€ ë„ë©”ì¸ ë‚´ì—ì„œ)
window.addEventListener('storage', function(e) {
  if (e.key === 'ipaSurveyData' || e.key === 'allProjects') {
    console.log('localStorage changed, refreshing projects...');
    loadProjects();
  }
});
</script>

</body>
</html>
